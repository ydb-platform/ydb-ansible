---
metadata:
  kind: MainConfig
  cluster: ""
  version: 5
config:
  yaml_config_enabled: true
  table_profiles_config:
    table_profiles:
    - name: default
      compaction_policy: default
      execution_policy: default
      partitioning_policy: default
      storage_policy: default
      replication_policy: default
      caching_policy: default
    compaction_policies:
    - name: default
    execution_policies:
    - name: default
    partitioning_policies:
    - name: default
      auto_split: true
      auto_merge: true
      size_to_split: 2147483648
    storage_policies:
    - name: default
      column_families:
      - storage_config:
          sys_log:
            preferred_pool_kind: ssd
          log:
            preferred_pool_kind: ssd
          data:
            preferred_pool_kind: ssd
    replication_policies:
    - name: default
    caching_policies:
    - name: default
  interconnect_config:
    merge_per_peer_counters: true
    max_inflight_amount_of_data_in_kb: 10240
    counter_merge_mode: PER_PEER
    handshake_timeout_duration: { seconds: 1 }
    encryption_mode: REQUIRED
    path_to_certificate_file: "/opt/ydb/certs/node.crt"
    path_to_private_key_file: "/opt/ydb/certs/node.key"
    path_to_ca_file: "/opt/ydb/certs/ca.crt"

allowed_labels:
  node_id:
    type: string
  host:
    type: string
  tenant:
    type: string

selector_config:

- description: cookie=testdb-01
  selector:
    tenant: /cluster1/testdb
  config:
    shared_cache_config:
      memory_limit: 51539607552
    feature_flags: !inherit
      enable_views: true
      enable_data_shard_volatile_transactions: true
    table_service_config:
      sql_version: 1
      index_auto_choose_mode: MAX_USED_PREFIX
      enable_implicit_query_parameter_types: true
      enable_kqp_data_query_stream_lookup: true
      enable_kqp_data_query_stream_idx_lookup_join: true
      resource_manager:
        kqp_pattern_cache_compiled_capacity_bytes: 524288000
        kqp_pattern_cache_capacity_bytes: 524288000
      query_limits:
        result_rows_limit: 20000
    resource_broker_config:
      queues:
      - name: queue_restore
        limit:
          cpu: 8
      - name: queue_backup
        limit:
          cpu: 8
    actor_system_config:
      executor:
      - name: System
        spin_threshold: '10'
        threads: 2
        max_threads: 11
        type: BASIC
      - name: User
        spin_threshold: '1'
        threads: 11
        max_threads: 15
        type: BASIC
      - name: Batch
        spin_threshold: '1'
        threads: 2
        max_threads: 6
        type: BASIC
      - name: IO
        threads: 1
        type: IO
      - name: IC
        spin_threshold: '10'
        threads: 7
        max_threads: 11
        time_per_mailbox_micro_secs: 100
        max_avg_ping_deviation: 500
        type: BASIC
      scheduler:
        progress_threshold: '10000'
        resolution: '64'
        spin_threshold: '0'
      sys_executor: 0
      user_executor: 1
      batch_executor: 2
      io_executor: 3
      service_executor:
      - executor_id: 4
        service_name: Interconnect

- description: cookie=admin-01
  selector:
    tenant: /cluster1/admin
  config:
    log_config:
      default_level: 4
    shared_cache_config:
      memory_limit: 17179869184
    feature_flags: !inherit
      enable_views: false
      enable_data_shard_volatile_transactions: false
    table_service_config:
      sql_version: 1
      index_auto_choose_mode: DISABLED
      enable_implicit_query_parameter_types: true
      enable_kqp_data_query_stream_lookup: false
      enable_kqp_data_query_stream_idx_lookup_join: false
      resource_manager:
        kqp_pattern_cache_compiled_capacity_bytes: 524288000
        kqp_pattern_cache_capacity_bytes: 524288000
      query_limits:
        result_rows_limit: 20000
    column_shard_config:
      disabled_on_scheme_shard: false
    actor_system_config:
      executor:
      - name: System
        spin_threshold: '10'
        threads: 1
        max_threads: 4
        type: BASIC
      - name: User
        spin_threshold: '1'
        threads: 3
        max_threads: 7
        type: BASIC
      - name: Batch
        spin_threshold: '1'
        threads: 1
        max_threads: 4
        type: BASIC
      - name: IO
        threads: 1
        type: IO
      - name: IC
        spin_threshold: '10'
        threads: 2
        max_threads: 4
        time_per_mailbox_micro_secs: 100
        max_avg_ping_deviation: 500
        type: BASIC
      scheduler:
        progress_threshold: '10000'
        resolution: '64'
        spin_threshold: '0'
      sys_executor: 0
      user_executor: 1
      batch_executor: 2
      io_executor: 3
      service_executor:
      - executor_id: 4
        service_name: Interconnect
